<div class="flex h-screen bg-gray-100">
  <app-teacher-sidebar></app-teacher-sidebar>

  <main class="flex-1 overflow-y-auto p-6">
    <div class="max-w-4xl mx-auto bg-white rounded-lg shadow-md p-8">
      <h2 class="text-3xl font-bold mb-6 text-blue-800">Assign Grades</h2>

      <!-- Select Course -->
      <div class="mb-6">
        <label for="course" class="block text-sm font-medium text-gray-700 mb-2"
          >Select Course</label
        >
        <select
          [(ngModel)]="selectedCourseId"
          name="course"
          (change)="onCourseSelect()"
          id="course"
          class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150"
        >
          <option value="" disabled selected>Select Course</option>
          <option *ngFor="let course of courses" [value]="course.id">
            {{ course.COURSE_NAME }}
          </option>
        </select>
      </div>

      <!-- Select Quiz/Assignment -->
      <div class="mb-6" *ngIf="quizzes.length">
        <label for="quiz" class="block text-sm font-medium text-gray-700 mb-2"
          >Select Quiz / Assignment</label
        >
        <select
          [(ngModel)]="selectedQuizId"
          name="quiz"
          (change)="onQuizSelect()"
          id="quiz"
          class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500 transition duration-150"
        >
          <option value="" disabled selected>Select Quiz / Assignment</option>
          <option *ngFor="let quiz of quizzes" [value]="quiz.id">
            {{ quiz.title }} ({{ quiz.type }})
          </option>
        </select>
      </div>

      <!-- Grade Entry Form -->
      <div *ngIf="gradeEntries.length" class="mt-6">
        <h3 class="text-xl font-semibold mb-4 text-gray-800">Enter Marks</h3>
        <form (ngSubmit)="submitGrades()" class="space-y-4">
          <div
            *ngFor="let entry of gradeEntries"
            [ngClass]="{
              'bg-green-50': entry.gradeId,
              'bg-white': !entry.gradeId
            }"
            class="flex flex-wrap items-center gap-4 p-3 border-b border-gray-200 rounded-md"
          >
            <div
              class="flex flex-wrap items-center gap-4 p-3 border-b border-gray-200"
            >
              <span class="w-full sm:w-1/2 md:w-2/5 font-medium text-gray-700">
                {{ getStudentNameById(entry.studentId) }}
              </span>

              <input
                [(ngModel)]="entry.marks"
                [name]="'marks_' + entry.studentId"
                type="number"
                min="0"
                class="w-full sm:w-1/2 md:w-1/4 px-3 py-2 border border-gray-300 rounded-md focus:ring-green-500 focus:border-green-500 transition duration-150"
                placeholder="Marks"
                required
              />

              <button
                *ngIf="entry.gradeId"
                type="button"
                (click)="deleteGrade(entry.gradeId)"
                class="text-red-600 text-sm underline ml-auto"
              >
                Delete
              </button>
            </div>
          </div>

          <button
            type="submit"
            class="mt-6 bg-green-600 hover:bg-green-700 text-white font-semibold px-6 py-2 rounded-md shadow transition duration-200"
          >
            Submit Grades
          </button>
        </form>
      </div>
    </div>
  </main>
</div>
